#include "main.h"
#include "pid_link.hpp"

using namespace control;

/*
 ******************************************************************************
 * DEFINES
 ******************************************************************************
 */

/*
 ******************************************************************************
 * EXTERNS
 ******************************************************************************
 */

/*
 ******************************************************************************
 * PROTOTYPES
 ******************************************************************************
 */

/*
 ******************************************************************************
 * GLOBAL VARIABLES
 ******************************************************************************
 */

/*
 ******************************************************************************
 ******************************************************************************
 * LOCAL FUNCTIONS
 ******************************************************************************
 ******************************************************************************
 */

/*
 ******************************************************************************
 * EXPORTED FUNCTIONS
 ******************************************************************************
 */
/**
 *
 */
PIDLink::PIDLink(float const &position, PidControlSelfDerivative<float> &pid) :
position(position),
pid(pid),
ready(false)
{
  return;
}

/**
 *
 */
void PIDLink::start(const PIDInit<float> &init) {
  pid.start(init, nullptr, nullptr);
  ready = true;
}

/**
 *
 */
void PIDLink::stop(void) {
  ready = false;
}

/**
 *
 */
float PIDLink::update(float target, float dT) {
  osalDbgCheck(ready);

  return pid(position, target, dT);
}


